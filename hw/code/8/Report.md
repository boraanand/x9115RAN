# Code 8: Report
## Using statistical machinery, evaluate rank of Differential Evolution, Simulated Annealing and Max WalkSat optimizers for DTLZ7 model ( 2 objectives and 10 decisions)

**Contributors:**  
  Anand Bora (abora)  
  Nirmesh Khandelwal (nbkhande)  
  Ravi Singh (rpsingh3)  

##Abstract:
------------------
Today, there are many well known optimization algorithms which are used to solve a wide randge of optimization problems.  
Each algorithm is different in the approach and can be better from each other for different models. Our main goal was to show the process of deciding which algorithm performs better for a given model.  
We implemented three types of comparisons- a) between candidate pairs, b) between sets of candidates from the same optimizer,  c) between sets of candidates from different optimizers.   
Then, we applied three optimization algorithms - Differential Evolution (DE) , MaxWalkSat (MWS) and Simulated Annealing (SA) on model DTLZ7( with 2 objectives and 10 decisions) to decide which one is the best for that model.

Keywords: DE, Simualted Anealing, MWS, Type1, Type2, Type3

##I. Introduction:
-------------------
There are two types of comparisons which are used in optimization algorithms and another type of comparison used to compare and decide which one is better among them for a given model.
For the paper, we have used DTLZ7 model to compare three different optimization algorithm - DE, SA, MWS.  
**Simulated Annealing** is an optimization algorithm which uses an probablistic technique to find a good solution(approximate global optimum) for a given model (or a function).  
**Differential evolution** is a stochastic, population-based optimization algorithm which optimizes a problem by iteratively trying to improve candidate solution with regard to given measure of quality.  
**MaxWalkSat** is a non-parametric stochastic method for sampling the landscape of the local region.
All these three uses different apporach to optimize a problem. 
Now, while implementing the above algorithms and comparing them below three types of comparisons are used (Less than operators):  
**Type1**. This operator is used for selecting better candidate between candidate pairs. If candidate "X" is better than candidate "Y", "X" is selected.  
**Type2**. This operator is used to between sets of candidates from the same optimizer for deciding early termination; i.e. if sets of candiadtes found in era+1 is no better that era.  
**Type3**. This operator is used to between sets of candidates from different optimizers for comparing the final eras generated by different optimizers. This will help in determining which optimizer is best among them.

The model for which the comparison was done is :
**DTLZ7**. This is one of the DTLZ (Deb, Thiele, Laumanns, Zitzler) multiobjective problems. It has 2 objectives and 10 decisions. More information on DTLZ7 model can be found at [DTLZ7] (http://e-collection.library.ethz.ch/eserv/eth:24696/eth-24696-01.pdf)

##II. Implementation:
--------------------
We implemented Differential Evolution, Simulated Annealing and MaxwalkSat to perform optimization on DTLZ7 model(with 2 objectives and 10 decisions)

DE: Pseudo code for Differenital Evolution
```
FOR i = 1 to max-tries DO
  solution = random assignment
  FOR j =1 to max-changes DO
    IF  score(solution) > threshold
        THEN  RETURN solution
    FI
    c = random part of solution 
    IF    p < random()
    THEN  change a random setting in c
    ELSE  change setting in c that maximizes score(solution) 
    FI
RETURN failure, best solution found
```

SA: Pseudo code for Simulated Annealing
```
s := s0; e := E(s)                  // Initial state, energy.
sb := s; eb := e                    // Initial "best" solution
k := 0                              // Energy evaluation count.
WHILE k < kmax and e > emax         // While time remains & not good enough:
  sn := neighbor(s)                 //   Pick some neighbor.
  en := E(sn)                       //   Compute its energy.
  IF    en < eb                     //   Is this a new best?
  THEN  sb := sn; eb := en          //     Yes, save it.
        print "!"
  FI
  IF    en < e                      // Should we jump to better?
  THEN  s := sn; e := en            //    Yes!
        print "+"                        
  FI
  ELSE IF P(e, en, k/kmax) < rand() // Should we jump to worse?
  THEN  s := sn; e := en            //    Yes, change state.
        print "?"
  FI
  ...
  print "."
  k := k + 1                        //   One more evaluation done    
  if k % 50 == 0: print "\n",sb
RETURN sb                           // Return the best solution found.
```

DE: Algorithm for Differential Evolution
```
Major difference in approach is forming the next era candidates.
At each iteration, for a candidate solution 
1. Three different random candidate solutions are picked from the frontier, say, X, Y and Z.
2. Now for each solution other than X,Y,Z , do uniform crossover and generate a new solution 
at some probability (called the crossover factor):
        New = X + f * (Y - Z)
3. If New is better than the old, then replace the old with the new.
```

DTLZ7 model:  

![Model](images/dtlz7_model.png)

For comparison between optimizers below four checks were followed and each algorithm was assigned a rank.   
1. Visualize the data.  
2. Check if the central tendency of one distribution is better than the other; e.g. compare their median values.  
3. Check the different between the central tendencies is not some small effect.  
4. Check if the distributions are significantly different.  

For step3, we used a12 method to determine the effect size.
The experiment was repeated 20 times, ie, each algorithm was run 20 times to optimize DTLZ7 model and then their final eras were compared to determine the rank.

The final eras for all three optimizers was stored and passed to scottknott, sk.py, to generate chart with rank of each optimizers.
We used rdiv list to store the final eras and passed it to rdivDemo method.

##III. Results
-----------------------------
Below are the results which were seen on running DE,SA, MWS algorithms 20 times on DTLZ7 model:

####For 1st iteration:
```
** Simulated Annealing  on  DTLZ_7 **
1.083357e+01 ???+???+?+?.???++.+?+?.?++...+.?..+.???++?+.+...+
1.083357e+01 .?+++!.......!....!!+...+.+...+.......!.??.??+++.?
Early Termination in era :  2.0

Best Denormalized Energy =  9.9995331096
At x =  (0.031744399441637206, 0.1789771228239846, 0.03602338498992885, 0.10934008624196245, 0.2758898287949425, 0.6146727007350734, 0.11252443715066751, 0.8956155320443971, 0.23509114147824794, 0.8483932934839943)

** MaxWalkSAT  on  DTLZ_7 **
1.444968e+01 ++.?++?+....+.+?.?..++++.+..++...?.....+.+.++++.+.
5.180549e+00 ....+..?+..?+?.+++++..+....+..?+++......?...++...+
Early Termination in era :  2.0
4.721360e+00 ?.++++.?+?++??++++?++..+.??+?+?++?.+?+?+++++.
Best Denormalized Energy =  4.72136022679
At x =  (0.27327899431505565, 0, 0, 0, 0, 0, 0, 0, 0.20889244088406578, 0)
Evals =  1124

** Differential Evolution  on  DTLZ_7 **
1.000034e+01 .+++.....+..+.....+.....+..+....+.+...+.++...+.+..
1.000034e+01 .+...+.+.+..+..+.+.+...+...+..+..+.+..++..?.......
Early Termination in era :  2

Best Denormalized Energy =  9.59045416053
At x =  (0.8222111440449, 0.28157240393939736, 0.44300231211948815, 0.14369309636882188, 0.20042172613738768, 0.26507324498365853, 0.829754229873439, 0.15210613296190453, 0.08310504364348209, 0.33914520372323703)
```
####For 10th iteration:
```
** Simulated Annealing  on  DTLZ_7 **
1.373317e+01 !??++!??++.?+!.++!.++?.?++..+?.+!.??.....+.!?...?
9.849205e+00 ?.+++.++!...+?.+..+..?..+....??+?++.+..++.+.+....+
Early Termination in era :  2.0

Best Denormalized Energy =  8.59472703546
At x =  (0.12399097527640912, 0.11268442473051499, 0.05280712414749589, 0.26236537436873675, 0.5395746376875099, 0.01015139880729865, 0.5387589705665072, 0.1296740831718426, 0.6738073137614734, 0.17219867069587835)

** MaxWalkSAT  on  DTLZ_7 **
1.238506e+01 +.+?++++..+..+...+..+..?+++.?++.....?+.+?+++...+++
4.226435e+00 ++.......+?+?+++.?+....+.?.+.++.+.??..?++.+.......
Early Termination in era :  2.0
4.226435e+00 ++.?.??++++.++.+?+..+...?.??++.??+++.+..?+++?
Best Denormalized Energy =  4.22643494056
At x =  (0, 0, 0, 0.12579718920101102, 0, 0, 0, 0, 0, 0)
Evals =  9601

** Differential Evolution  on  DTLZ_7 **
8.578773e+00 .....+++..++..+...+..+........+.++++......++...+..
Early Termination in era :  1

Best Denormalized Energy =  8.57877319454
At x =  (0.20463151184537254, 0.21608350621631234, 0.2338517693784029, 0.3505712502524321, 0.07030747054290076, 0.7217898876170029, 0.04360380422039167, 0.05203998752453276, 0.10615308376722077, 0.65121471164947)
```
####For 20th iteration :
```
** Simulated Annealing  on  DTLZ_7 **
1.193373e+01 ??++.??+!+?+!.?.+??+???.+?.++...+..+.!!..+.!+....
9.847492e+00 ?++..+?+.+??..+?..+++!.?..+!+....+..!...?+.+.??+?.
Early Termination in era :  2.0

Best Denormalized Energy =  7.96514864347
At x =  (0.0028439172035822358, 0.11525748664040614, 0.6497252707564142, 0.045124020194708625, 0.0021012288196270434, 0.4958760702760987, 0.040609381481309104, 0.3953325747863806, 0.28874965819801646, 0.16728309201946046)

** MaxWalkSAT  on  DTLZ_7 **
1.345641e+01 ??++++.+.........+..++++?......+....?+..??++?...+.
5.875884e+00 .+...++...+?+..+?.+....+.+.+...+++?..+.+?...+.....
Early Termination in era :  2.0
5.110045e+00 +++.+.+?++.++.??+?++?+++++++++++?++++?+.+?.+?
Best Denormalized Energy =  5.11004530443
At x =  (0.21982436498506175, 0.19416364015448961, 0, 0, 0, 0, 0, 0.25366345310877647, 0.05615626418311459, 0)
Evals =  19081

** Differential Evolution  on  DTLZ_7 **
9.577474e+00 .+..++..............+.....+++...+...+.+..+..+.++..
Early Termination in era :  1

Best Denormalized Energy =  9.57747416418
At x =  (0.8914811743615667, 0.54761635204422, 0.4431034178384131, 0.27337493544225866, 0.4181191257974015, 0.21758659124983015, 0.2562384139278675, 0.16244678706770965, 0.31037408033794955, 0.0009924417876221447)
```
#### Rank of DE, MWS and SA optimizers
```
rank ,      name ,    med   ,  iqr  
1 ,          mws ,    4.81  ,  0.64 (  -*-          |              ), 4.70,  4.82,  5.34  
2 ,           sa ,    9.09  ,  1.08 (               |     --*--    ), 8.55,  9.12,  9.63  
2 ,           de ,    9.27  ,  1.20 (               |     ---*--   ), 8.60,  9.31,  9.80  
```
From the above output, we can see that MWS gave the best results in our experiment.
For MWS, the rank 1 was given as it had the lowest median of 4.81 while others (DE and SA) were given rank 2 with similar values for median of ~9  
Please see the [8.log](https://github.com/boraanand/x9115RAN/blob/master/hw/code/8/8.log) for detailed output.

##IV Conclusions
------------------------------
MWS is the best optimizer for optimizing DTLZ7 problems with 2 objectives and 10 decisions.

##V. Threats to validity
---------------------------------
**1. Conclusion validity**  
The experiment was run 20 times to avoid this threat of validity.  
**2. Dependability**
The experiments were giving consistent results on every run. So, we are pretty sure that this threat is avoided as well.

##VI. Future Scope
The comparisions can be done on other variants of DTLZ7 model having more objectives and decisions.  
Also, the same experiment can be performed on different models like Schaffer,Kurasawa to know if MWS is really better than DE and SA for other models as well.

